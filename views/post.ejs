<%- include("partials/header") -%>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #f4f4f4;
        margin: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    .container {
        padding: 20px;
    }

    .search-container {
        display: flex;
        justify-content: center;
        margin-top: 15px;
    }
    
    .search-bar {
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        width: 300px;
        margin-right: 10px;
    }
    
    .search-button {
        padding: 10px 15px;
        border: none;
        background-color: #27374D;
        color: white;
        border-radius: 4px;
        cursor: pointer;
    }

    .search-button:hover {
        background-color: #1d2a4d;
    }

    .job-posting {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 15px auto;
        background-color: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        max-width: 600px;
        width: 100%;
    }
    
    .profile-photo img {
        width: 150px;
        height: 150px;
        border-radius: 8px;
        margin-bottom: 10px;
    }
    
    .job-details {
        text-align: center;
        max-width: 500px;
    }

    .job-details a {
        color: #1a0dab;
        text-decoration: none;
    }
    
    h2.post {
        margin: 10px 0;
        font-size: 22px;
        color: #27374D;
    }

    p.post {
        margin: 5px 0;
        color: #555;
    }

    footer {
        margin-top: auto;
        padding: 10px;
        background-color: #27374D;
        color: white;
        text-align: center;
    }

</style>

<div class="container">
    <div class="search-container">
        <input type="text" id="skillSearch" class="search-bar" placeholder="Search by skill...">
        <button id="searchBtn" class="search-button">Search</button>
    </div>

    <div id="postContainer">
        <% if (posts && posts.length > 0) { %>
            <% posts.forEach(post => { %>
                <div class="job-posting">
                    <div class="profile-photo">
                        <img src="<%= post.profile_photo || '/images/default_profile_photo.jpg' %>" alt="Profile Photo">
                    </div>
                    <div class="job-details">
                        <a href="javascript:void(0);" data_user_id="<%= post.user_id %>" onclick="viewProfile(this)">
                            <%= post.username %>
                        </a>
                        <h2 class="post"><%= post.title %></h2>
                        <p class="post"><strong>Skill:</strong> <%= post.skills %></p>
                        <p class="post"><strong>Description:</strong> <%= post.content %></p>
                        <p class="post"><strong>Date:</strong> <%= new Date(post.created_at).toLocaleDateString() %></p>
                    </div>
                </div>
            <% }) %>
        <% } else { %>
            <p>No posts found.</p>
        <% } %>
    </div>
</div>

<%- include("partials/footer") -%>

<script src="/view_profile.js"></script>
<script>
    document.getElementById('searchBtn').addEventListener('click', function() {
        const searchTerm = document.getElementById('skillSearch').value.toLowerCase();
        const posts = document.querySelectorAll('#postContainer .job-posting');
        posts.forEach(post => {
            const skill = post.querySelector('.post:nth-of-type(2)').innerText.toLowerCase();
            post.style.display = skill.includes(searchTerm) ? 'block' : 'none';
        });
    });
</script>
</body>
</html>
